<article class="post">
  <h1><%= post.title %></h1>

  <% if (post.coverImage) { %>
  <img src="<%= post.coverImage.replace('/public/', '/') %>" alt="<%= post.title %>" class="cover" />
  <% } %>

  <div class="meta" style="margin-top: 16px; color: #777">
    <%= post.publishedAt ? new Date(post.publishedAt).toDateString() : 'Draft'
    %>
  </div>
  <% if (displayAuthor) { %>
  <div class="meta" style="margin-top: 6px; color: #777;">
    by <%= displayAuthor %>
  </div>
  <% } %>

  <% if (post.document) { %>
  <div style="margin: 20px 0; padding: 15px; background: var(--bg-secondary); border-left: 2px solid var(--text-accent); display: flex; gap: 10px;">
    <a 
      href="<%= post.document.replace('/public/', '/') %>" 
      target="_blank"
      class="pdf-download-btn"
    >
      View PDF
    </a>
    <a 
      href="<%= post.document.replace('/public/', '/') %>" 
      download 
      class="pdf-download-btn"
    >
      Download PDF
    </a>
  </div>
  <% } %>

  <div class="content"><%- content || post.content %></div>

  <section
    id="comments"
    style="margin-top: 80px; padding-top: 40px; border-top: 1px solid #efefef"
  >
    <h2 style="font-size: 28px; font-weight: 400; margin-bottom: 30px">
      Comments
    </h2>

    <% if (comments.length === 0) { %>
    <p style="color: #999">
      No comments yet. Be the first to share your thoughts.
    </p>
    <% } else { %>
    <div style="margin-bottom: 40px">
      <% comments.forEach(c => { %>
      <div
        class="comment"
        style="
          margin-bottom: 30px;
          padding-bottom: 30px;
          border-bottom: 1px solid #efefef;
        "
      >
        <p style="margin: 0 0 10px 0">
          <strong><%= c.author || 'Anonymous' %></strong>
          <span style="color: #999; font-size: 14px">
            â€” <%= new Date(c.createdAt).toLocaleString() %></span
          >
        </p>
        <p style="margin: 0; color: #333; line-height: 1.7"><%= c.body %></p>
      </div>
      <% }) %>
    </div>
    <% } %>

    <form
      id="comment-form"
      action="/api/v1/comments/<%= post.id %>"
      method="post"
      style="margin-top: 40px"
    >
      <h3 style="font-size: 20px; font-weight: 400; margin-bottom: 20px">
        Leave a Comment
      </h3>

      <div style="margin-bottom: 20px">
        <input
          name="author"
          placeholder="Name (optional)"
          style="
            width: 100%;
            padding: 12px;
            border: 1px solid #efefef;
            font-family: inherit;
            font-size: 15px;
          "
        />
      </div>

      <div style="margin-bottom: 20px">
        <input
          name="email"
          placeholder="Email (optional)"
          style="
            width: 100%;
            padding: 12px;
            border: 1px solid #efefef;
            font-family: inherit;
            font-size: 15px;
          "
        />
      </div>

      <div style="margin-bottom: 20px">
        <textarea
          name="body"
          placeholder="Write a comment"
          required
          style="
            width: 100%;
            padding: 12px;
            border: 1px solid #efefef;
            font-family: inherit;
            font-size: 15px;
            min-height: 120px;
            resize: vertical;
          "
        ></textarea>
      </div>

      <button
        type="submit"
        style="
          background: #1a1a1a;
          color: white;
          border: none;
          padding: 12px 30px;
          cursor: pointer;
          font-family: sans-serif;
          font-size: 13px;
          font-weight: 600;
          letter-spacing: 1px;
          text-transform: uppercase;
          transition: opacity 0.3s ease;
        "
        onmouseover="this.style.opacity='0.7'"
        onmouseout="this.style.opacity='1'"
      >
        Submit Comment
      </button>
    </form>
  </section>
</article>
